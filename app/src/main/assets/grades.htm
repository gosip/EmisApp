<style>
	.sem_block	{
		width: 900px;
	}

	.block_title {
		width: 100%;
		height: 30px;
		background: #69C1F1;
		color: #000;
		line-height: 30px;
		text-align: center;
		font-size: 16px;
		cursor: pointer;
	}

	.block_table {
		width: 100%;
	}

	.block_table tbody tr td {
		padding: 10px;
		border-bottom: 1px solid #E6E6E6;
	}

	.block_table thead tr th {
		padding: 5px;
		border-bottom: 1px solid #E6E6E6;
	}

	.block_table tbody tr td:nth-child(1) {
		width: 350px;
	}
	.block_table tbody tr td:nth-child(2) {
		width: 150px;
	}
	.block_table tbody tr td:nth-child(3),
	.block_table tbody tr td:nth-child(4),
	.block_table tbody tr td:nth-child(5)
	{
		width: 50px;
		text-align: center;
	}


</style>

		<div class="sem_block">
			<div class="block_title">6 სემესტრი</div>
			<div class="block_content">
				<table class="block_table">
					<thead>
						<tr>
							<th>საგნის დასახელება</th>
							<th>ლექტორი</th>
							<th>კრედ</th>
							<th>ქულა</th>
							<th>შეფასება</th>
							<th>დეტალური</th>
						</tr>
					</thead>
					<tbody>
														<tr data-book-id="1537" data-lid="1296">
									<td>ოპტიმიზაციის თეორია</td>
									<td>ციმაკურიძე ნიკოლოზ </td>
									<td>6</td>
									<td>0</td>
									<td></td>
									<td><a href="#" class="get_det_est">შეფასება</a></td>
								</tr>
																<tr data-book-id="1371" data-lid="1306">
									<td>საველე პრაქტიკა II</td>
									<td>თავაძე შალვა ,მელიქიძე მაკა</td>
									<td>3</td>
									<td>0</td>
									<td></td>
									<td><a href="#" class="get_det_est">შეფასება</a></td>
								</tr>
																<tr data-book-id="1419" data-lid="1292">
									<td>მობილური აპლიკაციების ინჟინერია (Android)</td>
									<td>ბოჭორიშვილი გიორგი</td>
									<td>6</td>
									<td>31.15</td>
									<td>F</td>
									<td><a href="#" class="get_det_est">შეფასება</a></td>
								</tr>
																<tr data-book-id="1127" data-lid="1080">
									<td>კომპიუტერული არქიტექტურა</td>
									<td>გამეზარდაშვილი ზაზა</td>
									<td>3</td>
									<td>88.33</td>
									<td>B</td>
									<td><a href="#" class="get_det_est">შეფასება</a></td>
								</tr>
																<tr data-book-id="262" data-lid="1079">
									<td>ბიოლოგია</td>
									<td>ზაალიშვილი გიორგი</td>
									<td>6</td>
									<td>61</td>
									<td>D</td>
									<td><a href="#" class="get_det_est">შეფასება</a></td>
								</tr>
																<tr data-book-id="1128" data-lid="1081">
									<td>ოპერაციული სისტემების ინჟინერია</td>
									<td>კობიაშვილი გიორგი</td>
									<td>6</td>
									<td>0</td>
									<td></td>
									<td><a href="#" class="get_det_est">შეფასება</a></td>
								</tr>
													</tbody>
				</table>
			</div>	
		</div>
				<div class="sem_block">
			<div class="block_title">5 სემესტრი</div>
			<div class="block_content">
				<table class="block_table">
					<thead>
						<tr>
							<th>საგნის დასახელება</th>
							<th>ლექტორი</th>
							<th>კრედ</th>
							<th>ქულა</th>
							<th>შეფასება</th>
							<th>დეტალური</th>
						</tr>
					</thead>
					<tbody>
														<tr data-book-id="1115" data-lid="805">
									<td>ხელოვნური ინტელექტი</td>
									<td>ღვინეფაძე შოთა </td>
									<td>6</td>
									<td>82.2</td>
									<td>B</td>
									<td><a href="#" class="get_det_est">შეფასება</a></td>
								</tr>
																<tr data-book-id="1495" data-lid="962">
									<td>პროგრამული უზრუნველყოფის არქიტექტურული დიზაინის შაბლონები</td>
									<td>ფაჩუაშვილი ნიკოლოზ</td>
									<td>6</td>
									<td>91</td>
									<td>A</td>
									<td><a href="#" class="get_det_est">შეფასება</a></td>
								</tr>
																<tr data-book-id="1352" data-lid="807">
									<td>კომპიუტერული ქსელები</td>
									<td>კობიაშვილი გიორგი,კიკოლაშვილი გიორგი</td>
									<td>6</td>
									<td>61.7</td>
									<td>D</td>
									<td><a href="#" class="get_det_est">შეფასება</a></td>
								</tr>
																<tr data-book-id="1033" data-lid="804">
									<td>ფიზიკა</td>
									<td>ოსმანოვი ზაზა</td>
									<td>6</td>
									<td>64</td>
									<td>D</td>
									<td><a href="#" class="get_det_est">შეფასება</a></td>
								</tr>
													</tbody>
				</table>
			</div>	
		</div>
				<div class="sem_block">
			<div class="block_title">4 სემესტრი</div>
			<div class="block_content">
				<table class="block_table">
					<thead>
						<tr>
							<th>საგნის დასახელება</th>
							<th>ლექტორი</th>
							<th>კრედ</th>
							<th>ქულა</th>
							<th>შეფასება</th>
							<th>დეტალური</th>
						</tr>
					</thead>
					<tbody>
														<tr data-book-id="1124" data-lid="">
									<td>ფსიქოლოგია</td>
									<td></td>
									<td>4</td>
									<td>93</td>
									<td>A</td>
									<td></td>
								</tr>
																<tr data-book-id="1123" data-lid="">
									<td>ფილოსოფია</td>
									<td></td>
									<td>4</td>
									<td>91</td>
									<td>A</td>
									<td></td>
								</tr>
																<tr data-book-id="344" data-lid="">
									<td>კომპიუტერულ მეცნიერებათა სწავლება II</td>
									<td></td>
									<td>6</td>
									<td>100</td>
									<td>A</td>
									<td></td>
								</tr>
																<tr data-book-id="882" data-lid="">
									<td>კალკულუსი II</td>
									<td></td>
									<td>6</td>
									<td>87</td>
									<td>B</td>
									<td></td>
								</tr>
																<tr data-book-id="328" data-lid="">
									<td>პროგრამული უზრუნველყოფის ინჟინერია</td>
									<td></td>
									<td>6</td>
									<td>81</td>
									<td>B</td>
									<td></td>
								</tr>
																<tr data-book-id="327" data-lid="">
									<td>თეორიული ინფორმატიკა</td>
									<td></td>
									<td>6</td>
									<td>100</td>
									<td>A</td>
									<td></td>
								</tr>
																<tr data-book-id="884" data-lid="">
									<td>ალბათობა და სტატისტიკა</td>
									<td></td>
									<td>6</td>
									<td>82</td>
									<td>B</td>
									<td></td>
								</tr>
													</tbody>
				</table>
			</div>	
		</div>
				<div class="sem_block">
			<div class="block_title">3 სემესტრი</div>
			<div class="block_content">
				<table class="block_table">
					<thead>
						<tr>
							<th>საგნის დასახელება</th>
							<th>ლექტორი</th>
							<th>კრედ</th>
							<th>ქულა</th>
							<th>შეფასება</th>
							<th>დეტალური</th>
						</tr>
					</thead>
					<tbody>
														<tr data-book-id="1310" data-lid="">
									<td>ლიტერატურა და ხელოვნება</td>
									<td></td>
									<td>5</td>
									<td>78</td>
									<td>C</td>
									<td></td>
								</tr>
																<tr data-book-id="492" data-lid="">
									<td>მონაცემთა სტრუქტურები და ალგორითმები</td>
									<td></td>
									<td>6</td>
									<td>63</td>
									<td>D</td>
									<td></td>
								</tr>
																<tr data-book-id="343" data-lid="">
									<td>კომპიუტერულ მეცნიერებათა სწავლება I</td>
									<td></td>
									<td>6</td>
									<td>100</td>
									<td>A</td>
									<td></td>
								</tr>
																<tr data-book-id="899" data-lid="">
									<td>რაოდენობრივი და სივრცობრივი აზროვნება</td>
									<td></td>
									<td>4</td>
									<td>96</td>
									<td>A</td>
									<td></td>
								</tr>
																<tr data-book-id="325" data-lid="">
									<td>პროგრამირების პარადიგმები</td>
									<td></td>
									<td>6</td>
									<td>73</td>
									<td>C</td>
									<td></td>
								</tr>
																<tr data-book-id="881" data-lid="">
									<td>კალკულუსი I</td>
									<td></td>
									<td>6</td>
									<td>89</td>
									<td>B</td>
									<td></td>
								</tr>
																<tr data-book-id="1338" data-lid="">
									<td>თანამედროვე პოლიტიკური იდეოლოგიები</td>
									<td></td>
									<td>5</td>
									<td>75</td>
									<td>C</td>
									<td></td>
								</tr>
																<tr data-book-id="326" data-lid="">
									<td>მონაცემთა ბაზები</td>
									<td></td>
									<td>4</td>
									<td>83</td>
									<td>B</td>
									<td></td>
								</tr>
													</tbody>
				</table>
			</div>	
		</div>
				<div class="sem_block">
			<div class="block_title">2 სემესტრი</div>
			<div class="block_content">
				<table class="block_table">
					<thead>
						<tr>
							<th>საგნის დასახელება</th>
							<th>ლექტორი</th>
							<th>კრედ</th>
							<th>ქულა</th>
							<th>შეფასება</th>
							<th>დეტალური</th>
						</tr>
					</thead>
					<tbody>
														<tr data-book-id="323" data-lid="">
									<td>პროგრამირების აბსტრაქცია</td>
									<td></td>
									<td>6</td>
									<td>93</td>
									<td>A</td>
									<td></td>
								</tr>
																<tr data-book-id="876" data-lid="">
									<td>წრფივი ალგებრა</td>
									<td></td>
									<td>6</td>
									<td>96</td>
									<td>A</td>
									<td></td>
								</tr>
																<tr data-book-id="1065" data-lid="">
									<td>საველე პრაქტიკა I</td>
									<td></td>
									<td>4</td>
									<td>96</td>
									<td>A</td>
									<td></td>
								</tr>
																<tr data-book-id="1306" data-lid="">
									<td>ლოგიკა</td>
									<td></td>
									<td>3</td>
									<td>92</td>
									<td>A</td>
									<td></td>
								</tr>
																<tr data-book-id="878" data-lid="">
									<td>დისკრეტული მათემატიკა </td>
									<td></td>
									<td>6</td>
									<td>83</td>
									<td>B</td>
									<td></td>
								</tr>
																<tr data-book-id="257" data-lid="">
									<td>ანთროპოლოგია</td>
									<td></td>
									<td>2</td>
									<td>91</td>
									<td>A</td>
									<td></td>
								</tr>
																<tr data-book-id="1302" data-lid="">
									<td>ბუნებისმეტყველება </td>
									<td></td>
									<td>4</td>
									<td>97</td>
									<td>A</td>
									<td></td>
								</tr>
													</tbody>
				</table>
			</div>	
		</div>
				<div class="sem_block">
			<div class="block_title">1 სემესტრი</div>
			<div class="block_content">
				<table class="block_table">
					<thead>
						<tr>
							<th>საგნის დასახელება</th>
							<th>ლექტორი</th>
							<th>კრედ</th>
							<th>ქულა</th>
							<th>შეფასება</th>
							<th>დეტალური</th>
						</tr>
					</thead>
					<tbody>
														<tr data-book-id="345" data-lid="">
									<td>ეკონომიკის საფუძვლები</td>
									<td></td>
									<td>3</td>
									<td>74</td>
									<td>C</td>
									<td></td>
								</tr>
																<tr data-book-id="1107" data-lid="">
									<td>მსოფლიო ისტორია</td>
									<td></td>
									<td>4</td>
									<td>71</td>
									<td>C</td>
									<td></td>
								</tr>
																<tr data-book-id="894" data-lid="">
									<td>აზროვნების მათემატიკური წესი</td>
									<td></td>
									<td>5</td>
									<td>100</td>
									<td>A</td>
									<td></td>
								</tr>
																<tr data-book-id="1082" data-lid="">
									<td>ბიზნესის საფუძვლები I</td>
									<td></td>
									<td>4</td>
									<td>83</td>
									<td>B</td>
									<td></td>
								</tr>
																<tr data-book-id="322" data-lid="">
									<td>პროგრამირების მეთოდოლოგია</td>
									<td></td>
									<td>6</td>
									<td>94</td>
									<td>A</td>
									<td></td>
								</tr>
													</tbody>
				</table>
			</div>	
		</div>
		<style type='text/css'>
	.st_item_list {
		white-space: nowrap;
		overflow: hidden;
	}
	.st_th_sep {
		display: inline-block;
		width: 200px;
		height: 110px;
	}
	.st_item_par {
		display: inline-block;
		width: 40px;
	}
	.st_item {
		margin-left: -80px;
		transform:rotate(270deg);
		-ms-transform:rotate(270deg);
		-webkit-transform:rotate(270deg);
		min-height: 40px;
		line-height: 40px;
		min-width: 200px;
		display: inline-block;
		margin-top: 55px;
		text-indent: 10px;
		border: 1px solid #f5f5f5;
	}
	.st_book_line {
		height: 40px;
		line-height: 40px;
		white-space: nowrap;
		overflow: hidden;
		display:flex; 
		align-items:flex-start;
	}
	.st_book_item {
		display: inline-block;
		width: 200px !important;
		min-width: 200px !important;
		overflow: hidden;
		text-overflow: ellipsis;
		white-space: nowrap;
		height: 39px;
		line-height: 39px;
		border-top: 1px solid #f5f5f5;
		border-bottom: 1px solid #f5f5f5;
	}
	.st_est_item {
		display: inline-block;
		min-width: 39px;
		height: 38px;
		line-height: 38px;
		text-align: center;
		cursor: pointer;
		border: 1px solid #f5f5f5;
		border-right: none;
		border-bottom: none;
		background: #f5f5f5;
		box-shadow: 0px 0px 1px #000000;
		font-size: 10px;
	}
	.std_e_inp {
		display: inline-block;
		width: 35px;
		height: 35px;
		text-align: center;
		line-height: 35px;
		background: #FFFFFF;
		color: #000000;
		-webkit-border-radius: 5px;
		-moz-border-radius: 5px;
		border-radius: 5px;
	}
	.ui-tooltip1 {
		box-shadow: 0 0 5px #aaa;
		background-color: #363636 !important; 
		color: #FFFFFF !important;
		width: auto;
		max-width: none !important;
		margin: 0px !important;
		padding: 0px !important;
	}
	.ui-tooltip-content {
		padding: 0px !important;
		margin: 0px !important;
		background-color: #363636 !important;
		color: #FFFFFF !important;
		width: auto;
	}
</style>
<script type="text/javascript">
	$(function() {
		$('.get_det_est').click(function() {
			get_det_est(this);
			return false;
		});
	});


	function get_det_est(target) {
		var lid = $(target).closest('tr').attr('data-lid');
		
		$.ajax({
			type: "GET",
			url: "/index.php?mode=nishnebi&sub=est&lid="+lid,
			success: function (js) {
				if (typeof js == "string") {
					js = JSON.parse(js);
				}
				draw_est_table(js);
			}
		});

		// aq gamoushvi funqcia valer
	}
	//draw est table 
	function draw_est_table(est_data) {
		console.log(est_data);
		try {
			$(".show_component_dialog").dialog("close");
		} catch (ex) {}
		try {
			$(".show_component_dialog").remove();
		} catch (ex) {}
		$(document.createElement('div'))
		.addClass('show_component_dialog')
			.html('')
			.dialog({
				title: "შეფასება - " + est_data.lid.book_name,
				modal: true,
				width: 700,
				buttons: {
					"დახურვა": function() {
						$(this).dialog('close');
					}
				},
				open: function() {
					var _dialog = $(this);

					var comp_heads = est_data.comp;

					//gadalageba masivshi sortirebistvis
					var sorted_comps = [];
					for (var i in comp_heads) {
						sorted_comps.push(comp_heads[i]);
					}
					//sortireba
					sorted_comps.sort(function(a, b) {
						if (a.pos == b.pos) return 0;
						return 	a.pos>b.pos ? 1 : -1;
					});
					var h = '<div class="st_item_list"><div class="st_th_sep">&nbsp;</div>';
					for (var i in sorted_comps) {
						h += '<div class="st_item_par"><div st_id="'+sorted_comps[i].id+'" class="st_item">'+sorted_comps[i].name+'</div></div>';
					}
					h += '</div><div>';
					for (var student_id in est_data.students) {
						h += '<div class="st_book_line">';
							h += '<div class="st_book_item">'+est_data.lid.book_name+'</div>';
							var chatvla = "";
							for (var i in sorted_comps) {
								var n = "&nbsp;";
								if (est_data.est[student_id] != undefined) {
									if (est_data.est[student_id][sorted_comps[i].id] != undefined) {
										n = est_data.est[student_id][sorted_comps[i].id].shedegi;
									}
								}
								if ("1") {
									if (n == "S" || n == "T") {
										chatvla = n;
									}
									if (chatvla == "S" || chatvla == "T") {
										n = chatvla;
									}
								}
								h += $(document.createElement("div"))
									.append(
										$('<div title="." class="st_est_item" st_id="'+student_id+'">'+n+'</div>')
										.attr("n", JSON.stringify(est_data.est[student_id][sorted_comps[i].id]))
										.attr("c", JSON.stringify(sorted_comps[i]))
									)
								.html();
							}
						h += '</div>';
					}
					h += '</div>';
					$(".show_component_dialog").html(h);
					$(".st_est_item").tooltip({
						tooltipClass: "ui-tooltip1",
						content: function () {
							var n = $(this).attr("n");
							if (n != undefined) {
								n = JSON.parse(n);
								var c = $(this).attr("c");
								if (c != undefined) {
									c = JSON.parse(c);
									var h1 = "<tr><td width='75px'>N: </td>",
										h2 = "<tr><td>შეფასება: </td>",
										h3 = "<tr><td>მაქს.შეფასება:</td>",
										h4 = "<tr><td>ხვ.წონა:</td>",
										h5 = "<tr><td>შედეგი:</td>"
									;
									for (var i in c.data) {
										if ((i != "co_id") && (i != "shedegi")) {
											var val = "&nbsp;", shedegi = "&nbsp;";
											if (n[(i*1+1)] != undefined) {
												val = n[(i*1+1)].val;
												shedegi = n[(i*1+1)].shedegi;
												if (val == -1) {
													val = 'არა';
												}
											}
											h1 += "<td style='text-align: center; height: 20px'>"+(i*1+1)+"</td>";
											h2 += "<td style='text-align: center; height: 20px'><div class='std_e_inp'>"+val+"</div></td>";
											h3 += "<td style='text-align: center; height: 20px'>"+c.data[i].max_shefaseba+"</td>";
											h4 += "<td style='text-align: center; height: 20px'>"+c.data[i].xvedriti_cona+"</td>";
											h5 += "<td style='text-align: center; height: 20px'>"+shedegi+"</td>";
										}
									}
									h1 += "</tr>";
									h2 += "</tr>";
									h3 += "</tr>";
									h4 += "</tr>";
									h5 += "</tr>";
									var el = $(document.createElement("table"))
										.css({
											margin: 8,
											"font-size": "9px"
										})
										.append(h1, h2, h3, h4, h5)
									;
									return el;
								}
							}
							return "";
						}
					});
					/*
					for (var i in sorted_comps) {
						
						$('.show_comp_table thead tr', _dialog).append(
							$(document.createElement('th')).append(
								$(document.createElement('div')).addClass('comp_head_inner').html(sorted_comps[i].name)
									.css({
										"filter" 			: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0.083)",
										"-ms-filter" 		: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0.083)",
										"-moz-transform" 	: "rotate(-90.0deg)",
										"-ms-transform" 	: "rotate(-90.0deg)",
										"-o-transform" 		: "rotate(-90.0deg)",
										"-webkit-transform" : "rotate(-90.0deg)",
										"transform" 		: "rotate(-90.0deg)",
										"font-size"			: "10px",
										"font-family"		: "my_font",
										"height"			: "25px",
										"width"				: "180px"
									})
							).css({
    							"height" : "180px",
    							"width"  : "25px"
							})
						);
					}
					*/
				}
			})
	}
</script>